/*!
 * Name    : Video Background Extension for Jarallax
 * Version : 1.0.0
 * Author  : nK <https://nkdev.info>
 * GitHub  : https://github.com/nk-o/jarallax
 */!function(i){var o={};function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=i,a.c=o,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([,,function(e,t,i){e.exports=i(3)},function(e,t,i){"use strict";var o,a,n,r,p=i(4),l=(o=p)&&o.__esModule?o:{default:o};if("undefined"!=typeof jarallax){var s=jarallax.constructor,u=s.prototype.init;s.prototype.init=function(){var i=this;u.apply(i),i.video&&i.video.getIframe(function(e){var t=e.parentNode;i.css(e,{position:i.image.position,top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",margin:0,zIndex:-1}),i.$video=e,i.image.$container.appendChild(e),t.parentNode.removeChild(t)})};var d=s.prototype.coverImage;s.prototype.coverImage=function(){var e=this,t=d.apply(e),i=e.image.$item.nodeName;if(t&&e.video&&("IFRAME"===i||"VIDEO"===i)){var o=t.image.height,a=o*e.image.width/e.image.height,n=(t.container.width-a)/2,r=t.image.marginTop;t.container.width>a&&(o=(a=t.container.width)*e.image.height/e.image.width,n=0,r+=(t.image.height-o)/2),"IFRAME"===i&&(o+=400,r-=200),e.css(e.$video,{width:a+"px",marginLeft:n+"px",height:o+"px",marginTop:r+"px"})}return t};var y=s.prototype.initImg;s.prototype.initImg=function(){var e=this,t=y.apply(e);return e.options.videoSrc||(e.options.videoSrc=e.$item.getAttribute("data-jarallax-video")||null),e.options.videoSrc?(e.defaultInitImgResult=t,!0):t};var m=s.prototype.canInitParallax;s.prototype.canInitParallax=function(){var i=this,e=m.apply(i);if(!i.options.videoSrc)return e;var t=new l.default(i.options.videoSrc,{autoplay:!0,loop:!0,showContols:!1,startTime:i.options.videoStartTime||0,endTime:i.options.videoEndTime||0,mute:i.options.videoVolume?0:1,volume:i.options.videoVolume||0});if(t.isValid())if(e){if(t.on("ready",function(){if(i.options.videoPlayOnlyVisible){var e=i.onScroll;i.onScroll=function(){e.apply(i),i.isVisible()?t.play():t.pause()}}else t.play()}),t.on("started",function(){i.image.$default_item=i.image.$item,i.image.$item=i.$video,i.image.width=i.video.videoWidth||1280,i.image.height=i.video.videoHeight||720,i.options.imgWidth=i.image.width,i.options.imgHeight=i.image.height,i.coverImage(),i.clipContainer(),i.onScroll(),i.image.$default_item&&(i.image.$default_item.style.display="none")}),i.video=t,!i.defaultInitImgResult)return"local"!==t.type?(t.getImageURL(function(e){i.image.src=e,i.init()}),!1):(i.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",!0)}else i.defaultInitImgResult||t.getImageURL(function(e){var t=i.$item.getAttribute("style");t&&i.$item.setAttribute("data-jarallax-original-styles",t),i.css(i.$item,{"background-image":'url("'+e+'")',"background-position":"center","background-size":"cover"})});return e};var f=s.prototype.destroy;s.prototype.destroy=function(){var e=this;e.image.$default_item&&(e.image.$item=e.image.$default_item,delete e.image.$default_item),f.apply(e)},a=window,n="DOMContentLoaded",r=function(){jarallax(document.querySelectorAll("[data-jarallax-video]"))},a.addEventListener(n,r)}},function(e,t,i){"use strict";e.exports=i(5)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function o(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}}();function o(){this._done=[],this._fail=[]}function s(e,t,i){e.addEventListener(t,i)}o.prototype={execute:function(e,t){var i=e.length;for(t=Array.prototype.slice.call(t);i--;)e[i].apply(null,t)},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(e){this._done.push(e)},fail:function(e){this._fail.push(e)}};var r=0,p=0,l=0,u=0,d=0,y=new o,m=new o,f=function(){function o(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var i=this;i.url=e,i.options_default={autoplay:!1,loop:!1,mute:!1,volume:100,showContols:!0,startTime:0,endTime:0},i.options=i.extend({},i.options_default,t),i.videoID=i.parseURL(e),i.videoID&&(i.ID=r++,i.loadAPI(),i.init())}return n(o,[{key:"extend",value:function(i){var o=arguments;return i=i||{},Object.keys(arguments).forEach(function(t){o[t]&&Object.keys(o[t]).forEach(function(e){i[e]=o[t][e]})}),i}},{key:"parseURL",value:function(e){var t,i,o,a,n,r=!(!(t=e.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/))||11!==t[1].length)&&t[1],p=!(!(i=e.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/))||!i[3])&&i[3],l=(o=e.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/),a={},n=0,o.forEach(function(e){var t=e.match(/^(mp4|webm|ogv|ogg)\:(.*)/);t&&t[1]&&t[2]&&(a["ogv"===t[1]?"ogg":t[1]]=t[2],n=1)}),!!n&&a);return r?(this.type="youtube",r):p?(this.type="vimeo",p):!!l&&(this.type="local",l)}},{key:"isValid",value:function(){return!!this.videoID}},{key:"on",value:function(e,t){this.userEventsList=this.userEventsList||[],(this.userEventsList[e]||(this.userEventsList[e]=[])).push(t)}},{key:"off",value:function(i,o){var a=this;this.userEventsList&&this.userEventsList[i]&&(o?this.userEventsList[i].forEach(function(e,t){e===o&&(a.userEventsList[i][t]=!1)}):delete this.userEventsList[i])}},{key:"fire",value:function(e){var t=this,i=[].slice.call(arguments,1);this.userEventsList&&void 0!==this.userEventsList[e]&&this.userEventsList[e].forEach(function(e){e&&e.apply(t,i)})}},{key:"play",value:function(e){var t=this;t.player&&("youtube"===t.type&&t.player.playVideo&&(void 0!==e&&t.player.seekTo(e||0),YT.PlayerState.PLAYING!==t.player.getPlayerState()&&t.player.playVideo()),"vimeo"===t.type&&(void 0!==e&&t.player.setCurrentTime(e),t.player.getPaused().then(function(e){e&&t.player.play()})),"local"===t.type&&(void 0!==e&&(t.player.currentTime=e),t.player.paused&&t.player.play()))}},{key:"pause",value:function(){var t=this;t.player&&("youtube"===t.type&&t.player.pauseVideo&&YT.PlayerState.PLAYING===t.player.getPlayerState()&&t.player.pauseVideo(),"vimeo"===t.type&&t.player.getPaused().then(function(e){e||t.player.pause()}),"local"===t.type&&(t.player.paused||t.player.pause()))}},{key:"mute",value:function(){var e=this;e.player&&("youtube"===e.type&&e.player.mute&&e.player.mute(),"vimeo"===e.type&&e.player.setVolume&&e.player.setVolume(0),"local"===e.type&&(e.$iframe.muted=!0))}},{key:"unmute",value:function(){var e=this;e.player&&("youtube"===e.type&&e.player.mute&&e.player.unmute(),"vimeo"===e.type&&e.player.setVolume&&e.player.setVolume(e.options.volume),"local"===e.type&&(e.$iframe.muted=!1))}},{key:"setVolume",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this;t.player&&e&&("youtube"===t.type&&t.player.setVolume&&t.player.setVolume(e),"vimeo"===t.type&&t.player.setVolume&&t.player.setVolume(e),"local"===t.type&&(t.$iframe.volume=e/100))}},{key:"getImageURL",value:function(t){var i=this;if(i.videoImage)t(i.videoImage);else{if("youtube"===i.type){var e=["maxresdefault","sddefault","hqdefault","0"],o=0,a=new Image;a.onload=function(){120!==(this.naturalWidth||this.width)||o===e.length-1?(i.videoImage="https://img.youtube.com/vi/"+i.videoID+"/"+e[o]+".jpg",t(i.videoImage)):(o++,this.src="https://img.youtube.com/vi/"+i.videoID+"/"+e[o]+".jpg")},a.src="https://img.youtube.com/vi/"+i.videoID+"/"+e[o]+".jpg"}if("vimeo"===i.type){var n=new XMLHttpRequest;n.open("GET","https://vimeo.com/api/v2/video/"+i.videoID+".json",!0),n.onreadystatechange=function(){if(4===this.readyState&&200<=this.status&&this.status<400){var e=JSON.parse(this.responseText);i.videoImage=e[0].thumbnail_large,t(i.videoImage)}},n.send(),n=null}}}},{key:"getIframe",value:function(p){var l=this;l.$iframe?p(l.$iframe):l.onAPIready(function(){var e=void 0;if(l.$iframe||((e=document.createElement("div")).style.display="none"),"youtube"===l.type){l.playerOptions={},l.playerOptions.videoId=l.videoID,l.playerOptions.playerVars={autohide:1,rel:0,autoplay:0,playsinline:1},l.options.showContols||(l.playerOptions.playerVars.iv_load_policy=3,l.playerOptions.playerVars.modestbranding=1,l.playerOptions.playerVars.controls=0,l.playerOptions.playerVars.showinfo=0,l.playerOptions.playerVars.disablekb=1);var t=void 0,i=void 0;l.playerOptions.events={onReady:function(e){l.options.mute?e.target.mute():l.options.volume&&e.target.setVolume(l.options.volume),l.options.autoplay&&l.play(l.options.startTime),l.fire("ready",e)},onStateChange:function(e){l.options.loop&&e.data===YT.PlayerState.ENDED&&l.play(l.options.startTime),t||e.data!==YT.PlayerState.PLAYING||(t=1,l.fire("started",e)),e.data===YT.PlayerState.PLAYING&&l.fire("play",e),e.data===YT.PlayerState.PAUSED&&l.fire("pause",e),e.data===YT.PlayerState.ENDED&&l.fire("end",e),l.options.endTime&&(e.data===YT.PlayerState.PLAYING?i=setInterval(function(){l.options.endTime&&l.player.getCurrentTime()>=l.options.endTime&&(l.options.loop?l.play(l.options.startTime):l.pause())},150):clearInterval(i))}};var o=!l.$iframe;if(o){var a=document.createElement("div");a.setAttribute("id",l.playerID),e.appendChild(a),document.body.appendChild(e)}l.player=l.player||new window.YT.Player(l.playerID,l.playerOptions),o&&(l.$iframe=document.getElementById(l.playerID),l.videoWidth=parseInt(l.$iframe.getAttribute("width"),10)||1280,l.videoHeight=parseInt(l.$iframe.getAttribute("height"),10)||720)}if("vimeo"===l.type){l.playerOptions="",l.playerOptions+="player_id="+l.playerID,l.playerOptions+="&autopause=0",l.playerOptions+="&transparent=0",l.options.showContols||(l.playerOptions+="&badge=0&byline=0&portrait=0&title=0"),l.playerOptions+="&autoplay="+(l.options.autoplay?"1":"0"),l.playerOptions+="&loop="+(l.options.loop?1:0),l.$iframe||(l.$iframe=document.createElement("iframe"),l.$iframe.setAttribute("id",l.playerID),l.$iframe.setAttribute("src","https://player.vimeo.com/video/"+l.videoID+"?"+l.playerOptions),l.$iframe.setAttribute("frameborder","0"),e.appendChild(l.$iframe),document.body.appendChild(e)),l.player=l.player||new Vimeo.Player(l.$iframe),l.player.getVideoWidth().then(function(e){l.videoWidth=e||1280}),l.player.getVideoHeight().then(function(e){l.videoHeight=e||720}),l.options.startTime&&l.options.autoplay&&l.player.setCurrentTime(l.options.startTime),l.options.mute?l.player.setVolume(0):l.options.volume&&l.player.setVolume(l.options.volume);var n=void 0;l.player.on("timeupdate",function(e){n||l.fire("started",e),n=1,l.options.endTime&&l.options.endTime&&e.seconds>=l.options.endTime&&(l.options.loop?l.play(l.options.startTime):l.pause())}),l.player.on("play",function(e){l.fire("play",e),l.options.startTime&&0===e.seconds&&l.play(l.options.startTime)}),l.player.on("pause",function(e){l.fire("pause",e)}),l.player.on("ended",function(e){l.fire("end",e)}),l.player.on("loaded",function(e){l.fire("ready",e)})}if("local"===l.type){l.$iframe||(l.$iframe=document.createElement("video"),l.options.mute?l.$iframe.muted=!0:l.$iframe.volume&&(l.$iframe.volume=l.options.volume/100),l.options.loop&&(l.$iframe.loop=!0),l.$iframe.setAttribute("playsinline",""),l.$iframe.setAttribute("webkit-playsinline",""),l.$iframe.setAttribute("id",l.playerID),e.appendChild(l.$iframe),document.body.appendChild(e),Object.keys(l.videoID).forEach(function(e){var t,i,o,a;t=l.$iframe,i=l.videoID[e],o="video/"+e,(a=document.createElement("source")).src=i,a.type=o,t.appendChild(a)})),l.player=l.player||l.$iframe;var r=void 0;s(l.player,"playing",function(e){r||l.fire("started",e),r=1}),s(l.player,"timeupdate",function(){l.options.endTime&&l.options.endTime&&this.currentTime>=l.options.endTime&&(l.options.loop?l.play(l.options.startTime):l.pause())}),s(l.player,"play",function(e){l.fire("play",e)}),s(l.player,"pause",function(e){l.fire("pause",e)}),s(l.player,"ended",function(e){l.fire("end",e)}),s(l.player,"loadedmetadata",function(){l.videoWidth=this.videoWidth||1280,l.videoHeight=this.videoHeight||720,l.fire("ready"),l.options.autoplay&&l.play(l.options.startTime)})}p(l.$iframe)})}},{key:"init",value:function(){this.playerID="VideoWorker-"+this.ID}},{key:"loadAPI",value:function(){if(!p||!l){var e="";if("youtube"!==this.type||p||(p=1,e="https://www.youtube.com/iframe_api"),"vimeo"!==this.type||l||(l=1,e="https://player.vimeo.com/api/player.js"),e){var t=document.createElement("script"),i=document.getElementsByTagName("head")[0];t.src=e,i.appendChild(t),t=i=null}}}},{key:"onAPIready",value:function(e){if("youtube"===this.type&&("undefined"!=typeof YT&&0!==YT.loaded||u?"object"===("undefined"==typeof YT?"undefined":a(YT))&&1===YT.loaded?e():y.done(function(){e()}):(u=1,window.onYouTubeIframeAPIReady=function(){window.onYouTubeIframeAPIReady=null,y.resolve("done"),e()})),"vimeo"===this.type)if("undefined"!=typeof Vimeo||d)"undefined"!=typeof Vimeo?e():m.done(function(){e()});else{d=1;var t=setInterval(function(){"undefined"!=typeof Vimeo&&(clearInterval(t),m.resolve("done"),e())},20)}"local"===this.type&&e()}}]),o}();t.default=f}]);
//# sourceMappingURL=jarallax-video.min.js.map
