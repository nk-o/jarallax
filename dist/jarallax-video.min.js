/*!
 * Name    : Video Worker (wrapper for Youtube and Vimeo)
 * Version : 1.0.1
 * Author  : _nK http://nkdev.info
 * GitHub  : https://github.com/nk-o/jarallax
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";var t=function(){function t(t,o){var a=this;a.url=t,a.options_default={autoplay:1,loop:1,mute:1,controls:0},a.options=e.extend({},a.options_default,o),a.videoID=a.parseURL(t),a.videoID&&(a.ID=i++,a.loadAPI(),a.init())}var i=0;return t}();t.prototype.parseURL=function(e){function t(e){var t=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/,i=e.match(t);return i&&11===i[1].length?i[1]:!1}function i(e){var t=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,i=e.match(t);return i&&i[3]?i[3]:!1}var o=t(e),a=i(e);return o?(this.type="youtube",o):a?(this.type="vimeo",a):!1},t.prototype.isValid=function(){return!!this.videoID},t.prototype.on=function(e,t){this.userEventsList=this.userEventsList||[],(this.userEventsList[e]||(this.userEventsList[e]=[])).push(t)},t.prototype.off=function(e,t){if(this.userEventsList[e]&&this.userEventsList)if(t)for(var i=0;i<this.userEventsList[e].length;i++)this.userEventsList[e][i]===t&&(this.userEventsList[e][i]=!1);else delete this.userEventsList[e]},t.prototype.fire=function(e){var t=[].slice.call(arguments,1);if(this.userEventsList&&"undefined"!=typeof this.userEventsList[e])for(var i in this.userEventsList[e])this.userEventsList[e][i]&&this.userEventsList[e][i].apply(this,t)},t.prototype.play=function(){this.player&&("youtube"===this.type&&this.player.playVideo&&this.player.playVideo(),"vimeo"===this.type&&this.player.api("play"))},t.prototype.pause=function(){this.player&&("youtube"===this.type&&this.player.pauseVideo&&this.player.pauseVideo(),"vimeo"===this.type&&this.player.api("pause"))},t.prototype.getImageURL=function(t){var i=this;return i.videoImage?void t(i.videoImage):("youtube"===i.type&&(i.videoImage="https://img.youtube.com/vi/"+i.videoID+"/maxresdefault.jpg",t(i.videoImage)),void("vimeo"===i.type&&e.get("https://vimeo.com/api/v2/video/"+i.videoID+".json",function(e){i.videoImage=e[0].thumbnail_large,t(i.videoImage)})))},t.prototype.getIframe=function(t){var i=this;return i.$iframe?void t(i.$iframe):void i.onAPIready(function(){if("youtube"===i.type){i.playerOptions={},i.playerOptions.videoId=i.videoID,i.playerOptions.width=e(window).width(),i.playerOptions.playerVars={autohide:1,rel:0,autoplay:0},i.options.controls||(i.playerOptions.playerVars.iv_load_policy=3,i.playerOptions.playerVars.modestbranding=1,i.playerOptions.playerVars.controls=0,i.playerOptions.playerVars.showinfo=0,i.playerOptions.playerVars.disablekb=1);var o;i.playerOptions.events={onReady:function(e){i.options.mute&&e.target.mute(),i.options.autoplay&&i.play(),i.fire("ready",e)},onStateChange:function(e){i.options.loop&&e.data===YT.PlayerState.ENDED&&e.target.playVideo(),o||e.data!==YT.PlayerState.PLAYING||(o=1,i.fire("started",e))}},i.$iframe||e('<div style="display: none;"><div id="'+i.playerID+'"></div></div>').appendTo("body"),i.player=i.player||new window.YT.Player(i.playerID,i.playerOptions),i.$iframe=i.$iframe||e("#"+i.playerID)}if("vimeo"===i.type){if(i.playerOptions="",i.playerOptions+="player_id="+i.playerID,i.playerOptions+="&autopause=0",i.options.controls||(i.playerOptions+="&badge=0&byline=0&portrait=0&title=0"),i.playerOptions+="&autoplay=0",i.playerOptions+="&loop="+(i.options.loop?1:0),!i.$iframe){var a="https://player.vimeo.com/video/"+i.videoID+"?"+i.playerOptions;e('<div style="display: none;"><iframe id="'+i.playerID+'" src="'+a+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>').appendTo("body")}i.$iframe=i.$iframe||e("#"+i.playerID),i.player=i.player||$f(i.$iframe[0]),i.player.addEvent("ready",function(e){i.player.api("setVolume",i.options.mute?0:100),i.options.autoplay&&i.play();var t;i.player.addEvent("playProgress",function(e){t||i.fire("started",e),t=1}),i.fire("ready",e)})}t(i.$iframe)})},t.prototype.init=function(){var e=this;e.playerID="VideoWorker-"+e.ID};var i=0,o=0;t.prototype.loadAPI=function(){var e=this;if(!i||!o){var t="";"youtube"!==e.type||i||(i=1,t="//www.youtube.com/iframe_api"),"vimeo"!==e.type||o||(o=1,t="//f.vimeocdn.com/js/froogaloop2.min.js"),"file://"===window.location.origin&&(t="http:"+t);var a=document.createElement("script"),r=document.getElementsByTagName("head")[0];a.src=t,r.appendChild(a),r=null,a=null}};var a=0,r=0,n=e.Deferred(),p=e.Deferred();t.prototype.onAPIready=function(e){var t=this;if("youtube"===t.type&&("undefined"!=typeof YT&&0!==YT.loaded||a?"object"==typeof YT&&1===YT.loaded?e():n.done(function(){e()}):(a=1,window.onYouTubeIframeAPIReady=function(){window.onYouTubeIframeAPIReady=null,n.resolve("done"),e()})),"vimeo"===t.type)if("undefined"!=typeof $f||r)"undefined"!=typeof $f?e():p.done(function(){e()});else{r=1;var i=setInterval(function(){"undefined"!=typeof $f&&(clearInterval(i),p.resolve("done"),e())},20)}},window.VideoWorker=t}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";var t=e.fn.jarallax.constructor,i=t.prototype.init;t.prototype.init=function(){var t=this;i.apply(t),t.video&&t.video.getIframe(function(i){t.$video=e(i).css({position:"fixed",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",visibility:"visible",zIndex:-1}).appendTo(t.image.$container)})};var o=t.prototype.coverImage;t.prototype.coverImage=function(){var e=this;o.apply(e),e.video&&e.image.$item.is("iframe")&&e.image.$item.css({height:e.image.$item.height()+400,top:-200})};var a=t.prototype.initImg;t.prototype.initImg=function(){var t=this;if(t.options.videoSrc||(t.options.videoSrc=t.$item.attr("data-jarallax-video")||!1),t.options.videoSrc){var i=new VideoWorker(t.options.videoSrc);return i.isValid()&&(t.image.useImgTag=!0,i.on("ready",function(){function o(){t.isVisible()?i.play():i.pause()}e(window).on("DOMContentLoaded.jarallax-"+t.instanceID+" load.jarallax-"+t.instanceID+" resize.jarallax-"+t.instanceID+" scroll.jarallax-"+t.instanceID,o),o()}),i.on("started",function(){t.image.$default_item=t.image.$item,t.image.$item=t.$video,t.image.width=t.imgWidth=1280,t.image.height=t.imgHeight=720,t.coverImage(),t.clipContainer(),t.onScroll(),t.image.$default_item&&t.image.$default_item.fadeOut(500)}),t.video=i,i.getImageURL(function(e){t.image.src=e,t.init()})),!1}return a.apply(t)};var r=t.prototype.destroy;t.prototype.destroy=function(){var t=this;e(window).off(".jarallax-"+t.instanceID),r.apply(t)}});